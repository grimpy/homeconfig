#!/usr/bin/python3
import json
import subprocess
import os
import sys

tag = str(sys.argv[1])
cmd = sys.argv[2]

if "WAYLAND_DISPLAY" in os.environ:
    msgcmd = "swaymsg"
else:
    msgcmd = 'i3-msg'

proc = subprocess.Popen([msgcmd, '-t', 'get_workspaces'], stdout=subprocess.PIPE)
workspaces = json.load(proc.stdout)
for workspace in workspaces:
    if workspace['name'] == tag:
        subprocess.Popen([msgcmd, 'workspace', tag])
        sys.exit(0)

subprocess.Popen([msgcmd, 'workspace', tag])
os.execlp(cmd.split()[0], *cmd.split())
